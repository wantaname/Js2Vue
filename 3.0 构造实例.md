## 初始化实例

在Vue构造函数中，会调用

```js
this._init(options)
```

来初始化组件实例

初始化实例即在实例vm上添加属性(数据和方法)的过程

```js
vm._uid = uid++
```

组件id，每一个组件都有一个唯一的id

```js
vm._isVue = true
```

避免组件被observe【Vue中响应式对象首先要进行observe】

然后进行选项options的合并，即初始化vm.$options的过程。

```js
if (options && options._isComponent) {
    initInternalComponent(vm, options)
}else {
    vm.$options = mergeOptions(
        resolveConstructorOptions(vm.constructor),
        options || {},
        vm
      )
}
```

这里会判断是否是内部组件。因为子组件构造器extend Vue，会复用Vue实例的代码；对Vue实例与内部组件(子组件)的处理方式不同。

比如：

```js
<template id="t">
  <div :title="title">
    <div>{{title}}</div>
    <blog-post post-title="hello wolrd"></blog-post>
  </div>
</template>
```

```js
Vue.component('blog-post', {
    props: ['postTitle'],
    name:"hello",
    data:function (){
        return {
            "hello":"world"
        }
    },
    template:"<h1>{{postTitle}}</h1>"
})
var vm = new Vue({
    el: "#app"
    ...
}
```

这里的"blog-post"就是一个内部组件，而vm是Vue实例；在由vm的vnode生成真实node的过程中，遇到了子组件节点，则会去构造子组件实例。

按照代码执行顺序，我们这里只分析Vue实例的情况。

### 选项合并

